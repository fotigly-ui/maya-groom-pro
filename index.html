<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>Maya Groom Pro - Mobile Pet Grooming Appointments</title>

    <!-- Theme colors for mobile browsers and home screen -->
    <meta name="theme-color" content="#C7632C">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Maya Groom Pro">

    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root {
            --bg-primary: #F5EAD8;
            --bg-secondary: #FFF8ED;
            --bg-tertiary: #E8DCC8;
            --text-primary: #2A1F14;
            --text-secondary: #5A4A3A;
            --text-tertiary: #8A7A6A;
            --accent-primary: #C7632C;
            --accent-secondary: #E88D5A;
            --accent-dark: #9A4A1F;
            --border: #D4C5B3;
            --success: #6B9F7F;
            --warning: #D89545;
            --danger: #D94A3D;
        }

        .dark {
            --bg-primary: #1A1410;
            --bg-secondary: #2A2218;
            --bg-tertiary: #3A3028;
            --text-primary: #F5EAD8;
            --text-secondary: #D4C5B3;
            --text-tertiary: #A89682;
            --border: #4A3F35;
        }

        * {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        html, body {
            height: 100%;
            width: 100%;
            max-width: 100vw;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            box-sizing: border-box;
            touch-action: pan-x pan-y;
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background 0.3s, color 0.3s;
            font-size: 16px;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .mono {
            font-family: 'DM Mono', monospace;
        }

        .btn {
            padding: 0.625rem 1.25rem;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 0.875rem;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 25px -5px rgba(236, 72, 153, 0.4);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-sm {
            padding: 0.5rem 0.875rem;
            font-size: 0.75rem;
        }

        .uniform-tab {
            padding: 0.25rem 0.625rem;
            border-radius: 1rem;
            font-size: 0.688rem;
            font-weight: 600;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            min-width: 3.5rem;
            text-align: center;
        }

        .nav-tab {
            background: transparent;
            border: none;
            padding: 0.25rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.125rem;
            cursor: pointer;
            min-width: 0;
        }

        .nav-tab span {
            font-size: 0.625rem;
            font-weight: 600;
        }

        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 1.5rem;
            padding: 1rem;
            transition: all 0.3s;
        }

        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.1);
        }

        .input-field {
            width: 100%;
            padding: 0.625rem 0.875rem;
            border-radius: 0.5rem;
            border: 1.5px solid var(--border);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.2s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.1);
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            animation: fadeIn 0.2s forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: 1.75rem;
            max-width: 90%;
            width: 500px;
            max-height: 75vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            animation: slideUp 0.3s;
            margin-bottom: 6rem;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.25rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-tertiary);
            border: 1px solid transparent;
            font-size: 0.75rem;
        }

        .calendar-day:hover {
            border-color: var(--accent-secondary);
            background: var(--bg-secondary);
        }

        .calendar-day.selected {
            background: var(--accent-primary);
            color: white;
        }

        .calendar-day.has-appointments {
            border-color: var(--accent-primary);
        }

        .appointment-slot {
            padding: 1rem;
            border-radius: 1.25rem;
            border: 1.5px solid var(--border);
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .appointment-slot:hover {
            border-color: var(--accent-primary);
            background: var(--bg-tertiary);
        }

        .tab-button {
            padding: 0.625rem 1rem;
            background: transparent;
            border: none;
            color: var(--text-tertiary);
            font-weight: 600;
            font-size: 0.813rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .tab-button.active {
            color: var(--accent-primary);
            border-bottom-color: var(--accent-primary);
        }

        .badge {
            padding: 0.25rem 0.625rem;
            border-radius: 1rem;
            font-size: 0.688rem;
            font-weight: 600;
        }

        .badge-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .badge-primary {
            background: rgba(236, 72, 153, 0.1);
            color: var(--accent-primary);
        }

        /* Week Navigation Styles */
        .week-days-nav {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.125rem;
            margin-bottom: 0.25rem;
            padding: 0.125rem 0;
        }

        .week-day-item {
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            padding: 0.0625rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .week-day-label {
            font-size: 0.5625rem;
            color: var(--text-tertiary);
            margin-bottom: 0.0625rem;
            font-weight: 500;
        }

        .week-day-number {
            width: 1.25rem;
            height: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 0.5625rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .week-day-item:hover .week-day-number {
            background: var(--bg-tertiary);
        }

        .week-day-item.selected .week-day-number {
            background: var(--accent-primary);
            color: white;
        }

        .week-day-item.today .week-day-number {
            border: 2px solid var(--accent-primary);
        }

        .week-day-item.selected.today .week-day-number {
            border: none;
        }

        .week-nav-btn {
            background: var(--accent-primary);
            border: none;
            cursor: pointer;
            color: white;
            width: 1.125rem;
            min-width: 1.125rem;
            height: 1.125rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            transition: all 0.2s;
            border-radius: 50%;
            padding: 0.0625rem;
            flex-shrink: 0;
        }

        .week-nav-btn:hover {
            background: var(--accent-dark);
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .week-nav-btn:active {
            transform: scale(0.95);
        }

        @media (max-width: 640px) {
            .week-day-number {
                width: 1.375rem;
                height: 1.375rem;
                font-size: 0.625rem;
            }

            .week-day-label {
                font-size: 0.5625rem;
            }

            .timeline-hour {
                height: 3.5rem;
            }

            .week-nav-btn {
                width: 1.125rem;
                min-width: 1.125rem;
                height: 1.125rem;
            }
        }

        /* Single Day Timeline */
        .day-timeline {
            position: relative !important;
            touch-action: pan-y;
            min-height: 1152px;
        }

        .timeline-hour {
            height: var(--hour-height, 3rem);
            border-bottom: 1px solid var(--border);
            position: relative;
            display: flex;
            align-items: flex-start;
            padding-left: 3.5rem;
            cursor: pointer;
            transition: background 0.2s, height 0.15s ease-out;
            background-image: linear-gradient(
                to bottom,
                transparent 24.5%,
                var(--border) 24.5%,
                var(--border) 25.5%,
                transparent 25.5%,
                transparent 49.5%,
                var(--border) 49.5%,
                var(--border) 50.5%,
                transparent 50.5%,
                transparent 74.5%,
                var(--border) 74.5%,
                var(--border) 75.5%,
                transparent 75.5%
            );
            background-size: 100% 100%;
            background-position: 3.5rem 0;
        }

        .timeline-hour:hover {
            background-color: var(--bg-tertiary);
        }

        .timeline-hour-label {
            position: absolute;
            left: 0;
            top: 4px;
            font-size: 0.75rem;
            color: var(--text-tertiary);
            font-family: 'DM Mono', monospace;
            width: 3rem;
            text-align: right;
            padding-right: 0.5rem;
            white-space: nowrap;
            -webkit-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
        }

        /* CRITICAL: Prevent text selection in appointments */
        .timeline-appointment,
        .timeline-appointment * {
            -webkit-user-select: none !important;
            user-select: none !important;
            -webkit-touch-callout: none !important;
            -webkit-tap-highlight-color: transparent !important;
        }

        .timeline-appointment {
            position: absolute !important;
            background: rgba(59, 130, 246, 0.1);
            border-left: 3px solid #3B82F6;
            border-radius: 0.5rem;
            padding: 0.5rem 0.75rem;
            cursor: move;
            transition: all 0.2s;
            touch-action: none;
            font-size: 0.813rem;
            z-index: 10;
            box-sizing: border-box;
            overflow: hidden;
        }

        .timeline-appointment::selection,
        .timeline-appointment *::selection {
            background: transparent !important;
            color: inherit !important;
        }

        .timeline-appointment::-moz-selection,
        .timeline-appointment *::-moz-selection {
            background: transparent !important;
            color: inherit !important;
        }

        .timeline-appointment.recurring {
            background: rgba(168, 85, 247, 0.15);
            border-left: 3px solid #A855F7;
        }

        .timeline-appointment.recurring .timeline-appointment-title {
            color: #A855F7;
        }

        .timeline-appointment.completed {
            background: rgba(34, 197, 94, 0.15);
            border-left: 3px solid #22C55E;
        }

        .timeline-appointment.completed .timeline-appointment-title {
            color: #22C55E;
        }

        .timeline-appointment.cancelled {
            background: rgba(239, 68, 68, 0.15);
            border-left: 3px solid #EF4444;
            opacity: 0.6;
        }

        .timeline-appointment.cancelled .timeline-appointment-title {
            color: #EF4444;
            text-decoration: line-through;
        }

        .timeline-appointment:hover {
            background: rgba(59, 130, 246, 0.15);
            transform: translateX(2px);
        }

        .timeline-appointment.recurring:hover {
            background: rgba(168, 85, 247, 0.25);
        }

        .timeline-appointment.dragging {
            opacity: 0.7;
            z-index: 1000;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
        }

        .timeline-appointment-title {
            font-weight: 700;
            color: #3B82F6;
            font-size: 0.875rem;
            pointer-events: none;
        }

        /* Current time indicator */
        .current-time-line {
            position: absolute;
            left: 0;
            right: 0;
            height: 2px;
            background: #EF4444;
            z-index: 20;
            pointer-events: none;
        }

        .current-time-line::before {
            content: '';
            position: absolute;
            left: 3rem;
            top: -4px;
            width: 10px;
            height: 10px;
            background: #EF4444;
            border-radius: 50%;
        }

        .current-time-label {
            position: absolute;
            left: 0.25rem;
            top: -8px;
            font-size: 0.625rem;
            font-weight: 700;
            color: #EF4444;
            background: var(--bg-primary);
            padding: 0 2px;
        }

        .checkbox-custom {
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid var(--border);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checkbox-custom.checked {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        @media (max-width: 640px) {
            .modal-content {
                max-width: 95%;
                margin: 1rem;
            }

            .btn {
                padding: 0.625rem 1.25rem;
                font-size: 0.938rem;
            }

            .week-timeline {
                grid-template-columns: 50px repeat(7, 1fr);
            }

            .timeline-day-column {
                min-width: 100px;
            }
        }

        /* Utility Classes */
        .flex { display: flex; }
        .inline-flex { display: inline-flex; }
        .grid { display: grid; }
        .hidden { display: none !important; }
        .block { display: block; }
        .inline-block { display: inline-block; }

        .tab-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .items-center { align-items: center; }
        .items-start { align-items: flex-start; }
        .items-end { align-items: flex-end; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .justify-end { justify-content: flex-end; }

        .flex-col { flex-direction: column; }
        .flex-wrap { flex-wrap: wrap; }
        .flex-1 { flex: 1; }

        .gap-1 { gap: 0.25rem; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }

        .p-2 { padding: 0.5rem; }
        .p-3 { padding: 0.75rem; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .py-6 { padding-top: 1.5rem; padding-bottom: 1.5rem; }
        .pt-4 { padding-top: 1rem; }
        .pb-2 { padding-bottom: 0.5rem; }
        .pb-4 { padding-bottom: 1rem; }
        .pl-3 { padding-left: 0.75rem; }
        .pr-3 { padding-right: 0.75rem; }

        .m-0 { margin: 0; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .mx-4 { margin-left: 1rem; margin-right: 1rem; }
        .my-2 { margin-top: 0.5rem; margin-bottom: 0.5rem; }
        .my-4 { margin-top: 1rem; margin-bottom: 1rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-6 { margin-top: 1.5rem; }
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mr-1 { margin-right: 0.25rem; }
        .mr-2 { margin-right: 0.5rem; }
        .ml-2 { margin-left: 0.5rem; }

        .w-full { width: 100%; }
        .w-12 { width: 3rem; }
        .h-12 { height: 3rem; }
        .max-w-7xl { max-width: 80rem; }
        .max-w-sm { max-width: 24rem; }
        .min-w-0 { min-width: 0; }

        .text-xs { font-size: 0.688rem; line-height: 0.875rem; }
        .text-sm { font-size: 0.75rem; line-height: 1rem; }
        .text-base { font-size: 0.875rem; line-height: 1.25rem; }
        .text-lg { font-size: 1rem; line-height: 1.5rem; }
        .text-xl { font-size: 1.125rem; line-height: 1.5rem; }
        .text-2xl { font-size: 1.25rem; line-height: 1.625rem; }
        .text-3xl { font-size: 1.5rem; line-height: 1.875rem; }
        .text-4xl { font-size: 1.75rem; line-height: 2rem; }

        .font-semibold { font-weight: 600; }
        .font-bold { font-weight: 700; }

        .text-center { text-align: center; }
        .text-right { text-align: right; }

        .rounded { border-radius: 0.75rem; }
        .rounded-lg { border-radius: 1rem; }
        .rounded-full { border-radius: 9999px; }

        .border { border-width: 1px; }
        .border-t { border-top-width: 1px; }
        .border-b { border-bottom-width: 1px; }

        .overflow-x-auto { overflow-x: auto; }
        .overflow-y-auto { overflow-y: auto; }
        .overflow-hidden { overflow: hidden; }

        .cursor-pointer { cursor: pointer; }
        .cursor-move { cursor: move; }

        .sticky { position: sticky; }
        .fixed { position: fixed; }
        .relative { position: relative; }
        .absolute { position: absolute; }
        .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }

        .top-0 { top: 0; }
        .z-50 { z-index: 50; }

        .space-y-2 > * + * { margin-top: 0.5rem; }
        .space-y-3 > * + * { margin-top: 0.75rem; }
        .space-y-4 > * + * { margin-top: 1rem; }
        .space-y-6 > * + * { margin-top: 1.5rem; }

        .opacity-50 { opacity: 0.5; }
        .opacity-70 { opacity: 0.7; }
        .hover\:opacity-70:hover { opacity: 0.7; }
        .hover\:bg-opacity-10:hover { background-opacity: 0.1; }

        .transition-opacity { transition-property: opacity; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }

        /* Zoom overlay for timeline */
        .zoom-overlay {
            position: fixed;
            z-index: 99999;
            left: 50%;
            transform: translateX(-50%);
            bottom: 90px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 14px;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        .zoom-overlay.hidden { 
            display: none !important; 
        }
        
        .zoom-overlay .zoom-btn {
            width: 46px; 
            height: 46px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.15);
            color: #fff;
            font-size: 26px;
            line-height: 1;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .zoom-overlay .zoom-btn:active { 
            transform: scale(0.95);
            background: rgba(255,255,255,0.25);
        }
        
        .zoom-overlay .zoom-label {
            min-width: 64px;
            text-align: center;
            color: #fff;
            font-weight: 650;
            font-size: 14px;
        }

        /* Prevent page zoom while allowing timeline scroll */
        #timelineScrollContainer {
            touch-action: pan-y pinch-zoom;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="sticky top-0 z-50" style="background: var(--bg-secondary); border-bottom: 1px solid var(--border);">
        <div class="px-2 py-1 flex items-center justify-between">
            <div class="flex items-center gap-1">
                <div id="headerLogo" onclick="openLogoUpload()" style="cursor: pointer;">
                    <div class="flex items-center gap-2">
                        <div class="w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold" style="background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%); font-size: 1rem;">
                            <i class="fas fa-paw"></i>
                        </div>
                        <div>
                            <div class="font-bold" style="background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 1.25rem;">
                                Maya Groom Pro
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="openSettings()" class="p-1.5 rounded-lg hover:bg-opacity-10" style="background: var(--bg-tertiary);">
                    <i class="fas fa-gear" style="font-size: 0.938rem;"></i>
                </button>
                <button onclick="toggleDarkMode()" class="p-1.5 rounded-lg hover:bg-opacity-10" style="background: var(--bg-tertiary);">
                    <i class="fas fa-moon" style="font-size: 0.938rem;"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main style="height: calc