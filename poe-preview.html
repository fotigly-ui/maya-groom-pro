<!DOCTYPE html><html lang="en"><head><meta name="x-poe-datastore-behavior" content="local_only"><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PawPoint - Mobile Pet Grooming Appointments</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&amp;family=DM+Mono:wght@400;500&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #FAFAF9;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #F5F5F4;
            --text-primary: #1C1917;
            --text-secondary: #57534E;
            --text-tertiary: #78716C;
            --accent-primary: #EC4899;
            --accent-secondary: #F472B6;
            --accent-dark: #DB2777;
            --border: #E7E5E4;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
        }

        .dark {
            --bg-primary: #0C0A09;
            --bg-secondary: #1C1917;
            --bg-tertiary: #292524;
            --text-primary: #FAFAF9;
            --text-secondary: #D6D3D1;
            --text-tertiary: #A8A29E;
            --border: #44403C;
        }

        * {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background 0.3s, color 0.3s;
        }

        .mono {
            font-family: 'DM Mono', monospace;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 25px -5px rgba(236, 72, 153, 0.4);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: all 0.3s;
        }

        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.1);
        }

        .input-field {
            width: 100%;
            padding: 0.875rem 1rem;
            border-radius: 0.75rem;
            border: 1.5px solid var(--border);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.2s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.1);
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            animation: fadeIn 0.2s forwards;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: 1.25rem;
            max-width: 90%;
            width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-tertiary);
            border: 1.5px solid transparent;
        }

        .calendar-day:hover {
            border-color: var(--accent-secondary);
            background: var(--bg-secondary);
        }

        .calendar-day.selected {
            background: var(--accent-primary);
            color: white;
        }

        .calendar-day.has-appointments {
            border-color: var(--accent-primary);
        }

        .appointment-slot {
            padding: 1rem;
            border-radius: 0.75rem;
            border: 1.5px solid var(--border);
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .appointment-slot:hover {
            border-color: var(--accent-primary);
            background: var(--bg-tertiary);
        }

        .tab-button {
            padding: 0.875rem 1.5rem;
            background: transparent;
            border: none;
            color: var(--text-tertiary);
            font-weight: 600;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .tab-button.active {
            color: var(--accent-primary);
            border-bottom-color: var(--accent-primary);
        }

        .badge {
            padding: 0.375rem 0.875rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .badge-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .badge-primary {
            background: rgba(236, 72, 153, 0.1);
            color: var(--accent-primary);
        }

        @media (max-width: 640px) {
            .modal-content {
                max-width: 95%;
                margin: 1rem;
            }

            .btn {
                padding: 0.625rem 1.25rem;
                font-size: 0.938rem;
            }
        }
    </style>
<script src="https://puc.poecdn.net/authenticated_preview_page/syncedState.3f7572448765332f3047.js"></script></head>
<body>
    <!-- Header -->
    <header class="sticky top-0 z-50" style="background: var(--bg-secondary); border-bottom: 1px solid var(--border);">
        <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <i class="fas fa-paw text-2xl" style="color: var(--accent-primary);"></i>
                <h1 class="text-xl font-bold">PawPoint</h1>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="toggleDarkMode()" class="p-2 rounded-lg hover:bg-opacity-10" style="background: var(--bg-tertiary);">
                    <i class="fas fa-moon text-lg"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <div class="max-w-7xl mx-auto px-4 mt-6">
        <div class="flex gap-1 overflow-x-auto" style="border-bottom: 1px solid var(--border);">
            <button class="tab-button active" onclick="switchTab('calendar')">
                <i class="fas fa-calendar-days mr-2"></i>Calendar
            </button>
            <button class="tab-button" onclick="switchTab('clients')">
                <i class="fas fa-users mr-2"></i>Clients
            </button>
            <button class="tab-button" onclick="switchTab('services')">
                <i class="fas fa-scissors mr-2"></i>Services
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-6">
        <!-- Calendar View -->
        <div id="calendarView" class="tab-content">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold mb-1">Appointments</h2>
                    <p class="text-sm" style="color: var(--text-tertiary);" id="currentMonthYear"></p>
                </div>
                <button class="btn btn-primary" onclick="openNewAppointmentModal()">
                    <i class="fas fa-plus mr-2"></i>New Appointment
                </button>
            </div>

            <!-- Calendar -->
            <div class="card mb-6">
                <div class="flex justify-between items-center mb-4">
                    <button onclick="previousMonth()" class="p-2 rounded-lg hover:bg-opacity-10" style="background: var(--bg-tertiary);">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <h3 class="text-lg font-bold mono" id="calendarMonth"></h3>
                    <button onclick="nextMonth()" class="p-2 rounded-lg hover:bg-opacity-10" style="background: var(--bg-tertiary);">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <div class="calendar-grid mb-2">
                    <div class="text-center text-xs font-semibold p-2" style="color: var(--text-tertiary);">Sun</div>
                    <div class="text-center text-xs font-semibold p-2" style="color: var(--text-tertiary);">Mon</div>
                    <div class="text-center text-xs font-semibold p-2" style="color: var(--text-tertiary);">Tue</div>
                    <div class="text-center text-xs font-semibold p-2" style="color: var(--text-tertiary);">Wed</div>
                    <div class="text-center text-xs font-semibold p-2" style="color: var(--text-tertiary);">Thu</div>
                    <div class="text-center text-xs font-semibold p-2" style="color: var(--text-tertiary);">Fri</div>
                    <div class="text-center text-xs font-semibold p-2" style="color: var(--text-tertiary);">Sat</div>
                </div>

                <div class="calendar-grid" id="calendarDays"></div>
            </div>

            <!-- Appointments for Selected Day -->
            <div class="card">
                <h3 class="text-lg font-bold mb-4">
                    Appointments for <span id="selectedDate" class="mono" style="color: var(--accent-primary);"></span>
                </h3>
                <div id="appointmentsList"></div>
            </div>
        </div>

        <!-- Clients View -->
        <div id="clientsView" class="tab-content hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Clients &amp; Pets</h2>
                <button class="btn btn-primary" onclick="openNewClientModal()">
                    <i class="fas fa-plus mr-2"></i>New Client
                </button>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4" id="clientsList"></div>
        </div>

        <!-- Services View -->
        <div id="servicesView" class="tab-content hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Services</h2>
                <button class="btn btn-primary" onclick="openNewServiceModal()">
                    <i class="fas fa-plus mr-2"></i>New Service
                </button>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4" id="servicesList"></div>
        </div>
    </main>

    <script>
        // Data Storage
        let appointments = [];
        let clients = [];
        let services = [];
        let currentDate = new Date();
        let selectedDate = new Date();

        // Initialize with sample data
        function initializeData() {
            // Sample services
            services = [
                { id: 1, name: 'Full Grooming', duration: 120, price: 85, description: 'Bath, haircut, nail trim, ear cleaning' },
                { id: 2, name: 'Bath & Brush', duration: 60, price: 45, description: 'Bath, brush out, nail trim' },
                { id: 3, name: 'Nail Trim', duration: 15, price: 15, description: 'Quick nail trim service' },
                { id: 4, name: 'De-shedding Treatment', duration: 90, price: 65, description: 'Special treatment for heavy shedders' }
            ];

            // Sample clients
            clients = [
                {
                    id: 1,
                    name: 'Sarah Johnson',
                    email: 'sarah.j@email.com',
                    phone: '(555) 123-4567',
                    address: '123 Oak Street, Apt 4B',
                    pets: [
                        { name: 'Max', breed: 'Golden Retriever', age: 3, notes: 'Very friendly, loves treats' }
                    ]
                },
                {
                    id: 2,
                    name: 'Mike Chen',
                    email: 'mchen@email.com',
                    phone: '(555) 234-5678',
                    address: '456 Maple Avenue',
                    pets: [
                        { name: 'Luna', breed: 'Poodle', age: 2, notes: 'Anxious around clippers' },
                        { name: 'Charlie', breed: 'Poodle', age: 5, notes: 'Very calm' }
                    ]
                }
            ];

            // Sample appointments
            const today = new Date();
            appointments = [
                {
                    id: 1,
                    clientId: 1,
                    petName: 'Max',
                    serviceId: 1,
                    date: new Date(today.getFullYear(), today.getMonth(), today.getDate(), 10, 0),
                    status: 'confirmed',
                    notes: 'First time client'
                },
                {
                    id: 2,
                    clientId: 2,
                    petName: 'Luna',
                    serviceId: 2,
                    date: new Date(today.getFullYear(), today.getMonth(), today.getDate(), 14, 0),
                    status: 'confirmed',
                    notes: ''
                }
            ];

            renderCalendar();
            renderClients();
            renderServices();
            updateAppointmentsList();
        }

        // Calendar Functions
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            document.getElementById('calendarMonth').textContent =
                currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

            document.getElementById('currentMonthYear').textContent =
                currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';

            // Empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                calendarDays.appendChild(emptyDay);
            }

            // Days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';

                const date = new Date(year, month, day);
                const hasAppointments = appointments.some(apt =>
                    apt.date.toDateString() === date.toDateString()
                );

                if (hasAppointments) {
                    dayElement.classList.add('has-appointments');
                }

                if (date.toDateString() === selectedDate.toDateString()) {
                    dayElement.classList.add('selected');
                }

                dayElement.innerHTML = `
                    <span class="text-sm font-semibold">${day}</span>
                    ${hasAppointments ? '<div class="w-1 h-1 rounded-full mt-1" style="background: var(--accent-primary);"></div>' : ''}
                `;

                dayElement.onclick = () => {
                    selectedDate = date;
                    renderCalendar();
                    updateAppointmentsList();
                };

                calendarDays.appendChild(dayElement);
            }

            document.getElementById('selectedDate').textContent =
                selectedDate.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' });
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        }

        function updateAppointmentsList() {
            const dayAppointments = appointments.filter(apt =>
                apt.date.toDateString() === selectedDate.toDateString()
            ).sort((a, b) => a.date - b.date);

            const list = document.getElementById('appointmentsList');

            if (dayAppointments.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-8" style="color: var(--text-tertiary);">
                        <i class="fas fa-calendar-xmark text-4xl mb-3"></i>
                        <p>No appointments scheduled for this day</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = dayAppointments.map(apt => {
                const client = clients.find(c => c.id === apt.clientId);
                const service = services.find(s => s.id === apt.serviceId);
                const statusClass = apt.status === 'confirmed' ? 'badge-success' :
                                  apt.status === 'pending' ? 'badge-warning' : 'badge-danger';

                return `
                    <div class="appointment-slot" onclick="viewAppointment(${apt.id})">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <div class="font-bold text-lg mono">${apt.date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true })}</div>
                                <div class="text-sm mt-1" style="color: var(--text-secondary);">${service?.duration || 0} min</div>
                            </div>
                            <span class="badge ${statusClass}">${apt.status}</span>
                        </div>
                        <div class="font-semibold">${client?.name || 'Unknown'}</div>
                        <div class="text-sm" style="color: var(--text-secondary);">
                            <i class="fas fa-dog mr-1"></i>${apt.petName} • ${service?.name || 'Unknown Service'}
                        </div>
                        <div class="text-sm mt-1" style="color: var(--text-tertiary);">
                            <i class="fas fa-location-dot mr-1"></i>${client?.address || 'No address'}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Clients Functions
        function renderClients() {
            const list = document.getElementById('clientsList');

            if (clients.length === 0) {
                list.innerHTML = `
                    <div class="col-span-full text-center py-12" style="color: var(--text-tertiary);">
                        <i class="fas fa-users text-5xl mb-4"></i>
                        <p class="text-lg">No clients yet</p>
                        <p class="text-sm mt-2">Add your first client to get started</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = clients.map(client => `
                <div class="card card-hover">
                    <div class="flex justify-between items-start mb-3">
                        <div class="w-12 h-12 rounded-full flex items-center justify-center text-white text-xl font-bold" style="background: linear-gradient(135deg, var(--accent-primary), var(--accent-dark));">
                            ${client.name.charAt(0)}
                        </div>
                        <button onclick="editClient(${client.id})" class="p-2 rounded-lg hover:bg-opacity-10" style="background: var(--bg-tertiary);">
                            <i class="fas fa-ellipsis-vertical"></i>
                        </button>
                    </div>
                    <h3 class="font-bold text-lg mb-2">${client.name}</h3>
                    <div class="text-sm space-y-1 mb-3" style="color: var(--text-secondary);">
                        <div><i class="fas fa-envelope w-4"></i> ${client.email}</div>
                        <div><i class="fas fa-phone w-4"></i> ${client.phone}</div>
                        <div><i class="fas fa-location-dot w-4"></i> ${client.address}</div>
                    </div>
                    <div class="border-t pt-3" style="border-color: var(--border);">
                        <div class="text-xs font-semibold mb-2" style="color: var(--text-tertiary);">PETS</div>
                        ${client.pets.map(pet => `
                            <div class="flex items-center gap-2 mb-2">
                                <i class="fas fa-paw" style="color: var(--accent-primary);"></i>
                                <div class="flex-1">
                                    <div class="font-semibold text-sm">${pet.name}</div>
                                    <div class="text-xs" style="color: var(--text-tertiary);">${pet.breed}, ${pet.age} yrs</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        // Services Functions
        function renderServices() {
            const list = document.getElementById('servicesList');

            if (services.length === 0) {
                list.innerHTML = `
                    <div class="col-span-full text-center py-12" style="color: var(--text-tertiary);">
                        <i class="fas fa-scissors text-5xl mb-4"></i>
                        <p class="text-lg">No services yet</p>
                        <p class="text-sm mt-2">Add services you offer</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = services.map(service => `
                <div class="card card-hover">
                    <div class="flex justify-between items-start mb-3">
                        <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background: rgba(236, 72, 153, 0.1); color: var(--accent-primary);">
                            <i class="fas fa-scissors text-xl"></i>
                        </div>
                        <button onclick="editService(${service.id})" class="p-2 rounded-lg hover:bg-opacity-10" style="background: var(--bg-tertiary);">
                            <i class="fas fa-ellipsis-vertical"></i>
                        </button>
                    </div>
                    <h3 class="font-bold text-lg mb-2">${service.name}</h3>
                    <p class="text-sm mb-4" style="color: var(--text-secondary);">${service.description}</p>
                    <div class="flex justify-between items-center">
                        <div class="flex items-center gap-2">
                            <span class="badge badge-primary">
                                <i class="fas fa-clock mr-1"></i>${service.duration} min
                            </span>
                        </div>
                        <div class="text-xl font-bold mono" style="color: var(--accent-primary);">$${service.price}</div>
                    </div>
                </div>
            `).join('');
        }

        // Tab Switching
        function switchTab(tab) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));

            event.target.classList.add('active');
            document.getElementById(tab + 'View').classList.remove('hidden');
        }

        // Modal Functions
        function showModal(title, content, buttons) {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="p-6 border-b" style="border-color: var(--border);">
                        <div class="flex justify-between items-center">
                            <h2 class="text-xl font-bold">${title}</h2>
                            <button onclick="this.closest('.modal-overlay').remove()" class="p-2 rounded-lg hover:bg-opacity-10" style="background: var(--bg-tertiary);">
                                <i class="fas fa-xmark text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        ${content}
                    </div>
                    <div class="p-6 border-t flex gap-3 justify-end" style="border-color: var(--border);">
                        ${buttons}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            return modal;
        }

        function openNewAppointmentModal() {
            const content = `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2">Client</label>
                        <select id="aptClient" class="input-field" onchange="updatePetOptions()">
                            <option value="">Select client...</option>
                            ${clients.map(c => `<option value="${c.id}">${c.name}</option>`).join('')}
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Pet</label>
                        <select id="aptPet" class="input-field">
                            <option value="">Select pet...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Service</label>
                        <select id="aptService" class="input-field">
                            <option value="">Select service...</option>
                            ${services.map(s => `<option value="${s.id}">${s.name} - $${s.price} (${s.duration}min)</option>`).join('')}
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Date</label>
                        <input type="date" id="aptDate" class="input-field" value="${selectedDate.toISOString().split('T')[0]}">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Time</label>
                        <input type="time" id="aptTime" class="input-field" value="09:00">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Notes</label>
                        <textarea id="aptNotes" class="input-field" rows="3" placeholder="Any special instructions..."></textarea>
                    </div>
                </div>
            `;

            const buttons = `
                <button onclick="this.closest('.modal-overlay').remove()" class="btn btn-secondary">Cancel</button>
                <button onclick="saveAppointment()" class="btn btn-primary">Create Appointment</button>
            `;

            showModal('New Appointment', content, buttons);
        }

        function updatePetOptions() {
            const clientId = parseInt(document.getElementById('aptClient').value);
            const client = clients.find(c => c.id === clientId);
            const petSelect = document.getElementById('aptPet');

            if (client && client.pets) {
                petSelect.innerHTML = '<option value="">Select pet...</option>' +
                    client.pets.map(p => `<option value="${p.name}">${p.name} (${p.breed})</option>`).join('');
            } else {
                petSelect.innerHTML = '<option value="">Select pet...</option>';
            }
        }

        function saveAppointment() {
            const clientId = parseInt(document.getElementById('aptClient').value);
            const petName = document.getElementById('aptPet').value;
            const serviceId = parseInt(document.getElementById('aptService').value);
            const date = document.getElementById('aptDate').value;
            const time = document.getElementById('aptTime').value;
            const notes = document.getElementById('aptNotes').value;

            if (!clientId || !petName || !serviceId || !date || !time) {
                showAlert('Please fill in all required fields');
                return;
            }

            const appointmentDate = new Date(date + 'T' + time);

            appointments.push({
                id: appointments.length + 1,
                clientId,
                petName,
                serviceId,
                date: appointmentDate,
                status: 'confirmed',
                notes
            });

            document.querySelector('.modal-overlay').remove();
            renderCalendar();
            updateAppointmentsList();
            showAlert('Appointment created successfully!');
        }

        function openNewClientModal() {
            const content = `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2">Client Name</label>
                        <input type="text" id="clientName" class="input-field" placeholder="John Doe">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Email</label>
                        <input type="email" id="clientEmail" class="input-field" placeholder="john@email.com">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Phone</label>
                        <input type="tel" id="clientPhone" class="input-field" placeholder="(555) 123-4567">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Address</label>
                        <textarea id="clientAddress" class="input-field" rows="2" placeholder="123 Main Street, Apt 4B"></textarea>
                    </div>
                    <div class="border-t pt-4" style="border-color: var(--border);">
                        <label class="block text-sm font-semibold mb-2">Pet Information</label>
                        <div id="petsContainer">
                            <div class="pet-entry space-y-3 mb-4 p-4 rounded-lg" style="background: var(--bg-tertiary);">
                                <input type="text" placeholder="Pet name" class="input-field pet-name">
                                <input type="text" placeholder="Breed" class="input-field pet-breed">
                                <input type="number" placeholder="Age" class="input-field pet-age" min="0">
                                <textarea placeholder="Notes (e.g., temperament, allergies)" class="input-field pet-notes" rows="2"></textarea>
                            </div>
                        </div>
                        <button onclick="addPetEntry()" class="btn btn-secondary w-full">
                            <i class="fas fa-plus mr-2"></i>Add Another Pet
                        </button>
                    </div>
                </div>
            `;

            const buttons = `
                <button onclick="this.closest('.modal-overlay').remove()" class="btn btn-secondary">Cancel</button>
                <button onclick="saveClient()" class="btn btn-primary">Add Client</button>
            `;

            showModal('New Client', content, buttons);
        }

        function addPetEntry() {
            const container = document.getElementById('petsContainer');
            const entry = document.createElement('div');
            entry.className = 'pet-entry space-y-3 mb-4 p-4 rounded-lg';
            entry.style.background = 'var(--bg-tertiary)';
            entry.innerHTML = `
                <input type="text" placeholder="Pet name" class="input-field pet-name">
                <input type="text" placeholder="Breed" class="input-field pet-breed">
                <input type="number" placeholder="Age" class="input-field pet-age" min="0">
                <textarea placeholder="Notes (e.g., temperament, allergies)" class="input-field pet-notes" rows="2"></textarea>
            `;
            container.appendChild(entry);
        }

        function saveClient() {
            const name = document.getElementById('clientName').value;
            const email = document.getElementById('clientEmail').value;
            const phone = document.getElementById('clientPhone').value;
            const address = document.getElementById('clientAddress').value;

            if (!name || !email || !phone) {
                showAlert('Please fill in all required fields');
                return;
            }

            const petEntries = document.querySelectorAll('.pet-entry');
            const pets = [];

            petEntries.forEach(entry => {
                const petName = entry.querySelector('.pet-name').value;
                const breed = entry.querySelector('.pet-breed').value;
                const age = parseInt(entry.querySelector('.pet-age').value) || 0;
                const notes = entry.querySelector('.pet-notes').value;

                if (petName && breed) {
                    pets.push({ name: petName, breed, age, notes });
                }
            });

            if (pets.length === 0) {
                showAlert('Please add at least one pet');
                return;
            }

            clients.push({
                id: clients.length + 1,
                name,
                email,
                phone,
                address,
                pets
            });

            document.querySelector('.modal-overlay').remove();
            renderClients();
            showAlert('Client added successfully!');
        }

        function openNewServiceModal() {
            const content = `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2">Service Name</label>
                        <input type="text" id="serviceName" class="input-field" placeholder="Full Grooming">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Description</label>
                        <textarea id="serviceDescription" class="input-field" rows="3" placeholder="Bath, haircut, nail trim..."></textarea>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">Duration (minutes)</label>
                            <input type="number" id="serviceDuration" class="input-field" placeholder="60" min="1">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">Price ($)</label>
                            <input type="number" id="servicePrice" class="input-field" placeholder="45" min="0" step="0.01">
                        </div>
                    </div>
                </div>
            `;

            const buttons = `
                <button onclick="this.closest('.modal-overlay').remove()" class="btn btn-secondary">Cancel</button>
                <button onclick="saveService()" class="btn btn-primary">Add Service</button>
            `;

            showModal('New Service', content, buttons);
        }

        function saveService() {
            const name = document.getElementById('serviceName').value;
            const description = document.getElementById('serviceDescription').value;
            const duration = parseInt(document.getElementById('serviceDuration').value);
            const price = parseFloat(document.getElementById('servicePrice').value);

            if (!name || !description || !duration || !price) {
                showAlert('Please fill in all fields');
                return;
            }

            services.push({
                id: services.length + 1,
                name,
                description,
                duration,
                price
            });

            document.querySelector('.modal-overlay').remove();
            renderServices();
            showAlert('Service added successfully!');
        }

        function viewAppointment(id) {
            const apt = appointments.find(a => a.id === id);
            if (!apt) return;

            const client = clients.find(c => c.id === apt.clientId);
            const service = services.find(s => s.id === apt.serviceId);

            const content = `
                <div class="space-y-4">
                    <div class="p-4 rounded-lg" style="background: var(--bg-tertiary);">
                        <div class="text-sm" style="color: var(--text-tertiary);">DATE & TIME</div>
                        <div class="text-xl font-bold mono mt-1">
                            ${apt.date.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}
                        </div>
                        <div class="text-lg mono" style="color: var(--accent-primary);">
                            ${apt.date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true })}
                        </div>
                    </div>

                    <div>
                        <div class="text-sm font-semibold mb-2" style="color: var(--text-tertiary);">CLIENT</div>
                        <div class="font-semibold">${client?.name || 'Unknown'}</div>
                        <div class="text-sm" style="color: var(--text-secondary);">${client?.phone || ''}</div>
                    </div>

                    <div>
                        <div class="text-sm font-semibold mb-2" style="color: var(--text-tertiary);">ADDRESS</div>
                        <div>${client?.address || 'No address'}</div>
                    </div>

                    <div>
                        <div class="text-sm font-semibold mb-2" style="color: var(--text-tertiary);">PET</div>
                        <div class="font-semibold">
                            <i class="fas fa-paw mr-2" style="color: var(--accent-primary);"></i>${apt.petName}
                        </div>
                    </div>

                    <div>
                        <div class="text-sm font-semibold mb-2" style="color: var(--text-tertiary);">SERVICE</div>
                        <div class="font-semibold">${service?.name || 'Unknown'}</div>
                        <div class="text-sm" style="color: var(--text-secondary);">${service?.duration || 0} minutes • $${service?.price || 0}</div>
                    </div>

                    ${apt.notes ? `
                        <div>
                            <div class="text-sm font-semibold mb-2" style="color: var(--text-tertiary);">NOTES</div>
                            <div>${apt.notes}</div>
                        </div>
                    ` : ''}

                    <div>
                        <div class="text-sm font-semibold mb-2" style="color: var(--text-tertiary);">STATUS</div>
                        <span class="badge ${apt.status === 'confirmed' ? 'badge-success' : apt.status === 'pending' ? 'badge-warning' : 'badge-danger'}">
                            ${apt.status}
                        </span>
                    </div>
                </div>
            `;

            const buttons = `
                <button onclick="deleteAppointment(${id})" class="btn btn-secondary" style="background: var(--danger); color: white;">
                    <i class="fas fa-trash mr-2"></i>Delete
                </button>
                <button onclick="this.closest('.modal-overlay').remove()" class="btn btn-primary">Close</button>
            `;

            showModal('Appointment Details', content, buttons);
        }

        function deleteAppointment(id) {
            showConfirm('Are you sure you want to delete this appointment?', () => {
                appointments = appointments.filter(a => a.id !== id);
                document.querySelector('.modal-overlay').remove();
                renderCalendar();
                updateAppointmentsList();
                showAlert('Appointment deleted');
            });
        }

        function editClient(id) {
            // Simplified - just show alert for now
            showAlert('Client editing feature - coming soon!');
        }

        function editService(id) {
            // Simplified - just show alert for now
            showAlert('Service editing feature - coming soon!');
        }

        // Custom Dialog Functions
        function showAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 400px;">
                    <div class="p-6">
                        <div class="text-center mb-4">
                            <div class="w-12 h-12 rounded-full mx-auto flex items-center justify-center" style="background: rgba(236, 72, 153, 0.1);">
                                <i class="fas fa-info-circle text-2xl" style="color: var(--accent-primary);"></i>
                            </div>
                        </div>
                        <p class="text-center mb-6">${message}</p>
                        <button onclick="this.closest('.modal-overlay').remove()" class="btn btn-primary w-full">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showConfirm(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 400px;">
                    <div class="p-6">
                        <div class="text-center mb-4">
                            <div class="w-12 h-12 rounded-full mx-auto flex items-center justify-center" style="background: rgba(239, 68, 68, 0.1);">
                                <i class="fas fa-exclamation-triangle text-2xl" style="color: var(--danger);"></i>
                            </div>
                        </div>
                        <p class="text-center mb-6">${message}</p>
                        <div class="flex gap-3">
                            <button onclick="this.closest('.modal-overlay').remove()" class="btn btn-secondary flex-1">Cancel</button>
                            <button onclick="handleConfirm()" class="btn btn-primary flex-1">Confirm</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            window.handleConfirm = () => {
                modal.remove();
                onConfirm();
            };
        }

        // Dark Mode
        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
        }

        // Initialize dark mode based on user preference
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Initialize app
        initializeData();
    </script>



</body></html>